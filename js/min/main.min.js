$(document).ready(function(){function e(e){p=L.geoJson(e).addTo(f)}function o(e){var o=e.target;o.bindPopup(o.feature.properties.NAME),o.on("mouseover",function(){this.openPopup()}),o.on("mouseout",function(){this.closePopup()}),o.setStyle({weight:5,color:"black",dashArray:"",fillOpacity:1})}function t(e){var o;for(key in h)key===e.trim()&&(o=h[key],console.log(o),o.setStyle({weight:5,color:"black",dashArray:"",fillOpacity:1,fillColor:"yellow"}))}function n(e){geojson.resetStyle(e.target)}function a(e,t){t.on({mouseover:o,mouseout:n,dblclick:c})}function r(){return{fillColor:"red",weight:2,opacity:1,color:"white",dashArray:"3",fillOpacity:1}}function c(e){f.fitBounds(e.target.getBounds())}function s(e){var o=e+".csv",t="/data/csv/"+o;Papa.parse(t,{download:!0,delimiter:",",complete:function(e){u(e.data[0],e.data)}})}function l(e){var o=e.toLowerCase(),t=o.replace(/ /g,"_");return t}function u(e,o){var n=!1;for($("#county").empty(),j=1;j<o.length;j++)for(n=!1,k=0;k<o[j].length;k++)if("TRUE"==o[j][k]&&0==n){n=!0;var a="";a='<option value="'+o[j][0]+'">'+o[j][0]+"</option>",$("#county").append(a),$("#county").trigger("chosen:updated"),console.log(o[j][0]),t(o[j][0])}var a="";for(i=1;i<e.length;i++)a+='<option value="'+e[i]+'">'+e[i]+"</option>";$("#year").append(a),$("#year").trigger("chosen:updated")}var f,d,p,g,h=[];g=screen.height,console.log(g,screen.width),$(".chosen-select").chosen(),$("#dataTable").DataTable(),f=L.map("map",{center:[44.7,-90],zoom:7,minZoom:7}),f.setMaxBounds([[49,-85],[42,-94]]),d=L.tileLayer("http://{s}.acetate.geoiq.com/tiles/acetate/{z}/{x}/{y}.png",{attribution:"Acetate tileset from GeoIQ Data from Wikipedia"}).addTo(f),$.getJSON("data/WI_Counties_geojson.geojson").done(function(o){e(o),geojson=L.geoJson(o,{onEachFeature:a,style:r}).addTo(f);var t=geojson._layers;for(key in t){var n=t[key].feature.properties.NAME;h[n]=t[key]}}).fail(function(){alert("There was a problem loading data")}),$(function(){$("input#search_button").click(function(){var e,o;$("#county_chosen").find(".chosen-single").each(function(){e=$(this).find("span").text()}),$("#type_chosen").find(".chosen-single").each(function(){o=$(this).find("span").text()}),console.log(e);var t=l(o);s(t)})})});