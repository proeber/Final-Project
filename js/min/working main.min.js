$(document).ready(function(){function o(o){var e=[],t=1/0,n=-1/0;for(var a in o.features){var r=o.features[a].properties;for(var i in r)"Latitude"!=i&&"Longitude"!=i&&"Post_season_streak"!=i&&"Team"!=i&&(r[i]<t&&(t=r[i]),r[i]>n&&(n=r[i]),-1===$.inArray(i,e)&&e.push(i),""===r[i]&&(r[i]=0))}return{timestamps:e,min:t,max:n}}function e(o,e){l=L.geoJson(e,{pointToLayer:function(o,e){return L.circleMarker(e,{fillColor:"red",color:"red",weight:1,fillOpacity:.6}).on({mouseover:function(){this.openPopup(),this.setStyle({color:"blue"})},mouseout:function(){this.closePopup(),this.setStyle({color:"#537898"})}})}}),t(o[0])}function t(o){l.eachLayer(function(e){var t=e.feature.properties;console.log(t);var n=i(t[o]);console.log(n);var a="<b> "+t.Team+"</b></br> # of years on streak: "+t[o]+"</br>  Year: "+o;console.log(a),""===n?e.setRadius(0):e.setRadius(n),e.bindPopup(a,{offset:new L.point(0,-n)})}).addTo(s)}function n(o,e){function t(o){return 10*Math.round(o/10)}10>o&&(o=10);var n=L.control({position:"bottomright"});n.onAdd=function(){var n,a,r,s=L.DomUtil.create("div","legend"),l=L.DomUtil.create("div","symbolsContainer"),c=[t(o),t((e-o)/2),t(e)],u=0;L.DomEvent.addListener(s,"mousedown",function(o){L.DomEvent.stopPropagation(o)}),$(s).append("<h2 id='legendTitle'># of Playoffs in a Row</h2>");for(var p=0;p<=c.length-1;p++)n=L.DomUtil.create("div","legendCircle"),a=i(c[p]),r=-a-u-2,$(n).attr("style","width: "+2*a+"px; height: "+2*a+"px; margin-left: "+r+"px"),$(n).append("<span class='legendValue'>"+c[p]+"<span>"),$(l).append(n),u=a;return $(s).append(l),s},n.addTo(s)}function a(o){var e=L.control({position:"bottomleft"});e.onAdd=function(){var e=L.DomUtil.create("input","range-slider");return L.DomEvent.addListener(e,"mousedown",function(o){L.DomEvent.stopPropagation(o)}),console.log(o.length),$(e).attr({type:"range",max:82,min:0,step:1,value:0}).on("input",function(){t(o[$(this).val()]),$(".temporal-legend").text(o[this.value])}),e},e.addTo(s),r(o[0])}function r(){var o=L.control({postion:"bottomleft"});o.onAdd=function(){var o=L.DomUtil.create("output","temporal-legend");return console.log(o),o},o.addTo(s)}function i(o){var e=10,t=o*e,n=2*Math.sqrt(t/Math.PI);return n}var s,l,c,u=document.querySelector("button");console.log(u),s=L.map("map",{center:[43,-96],zoom:4,minZoom:4}),c=L.tileLayer("http://{s}.acetate.geoiq.com/tiles/acetate/{z}/{x}/{y}.png",{attribution:"Acetate tileset from GeoIQ Data from Wikipedia"}).addTo(s),u.addEventListener("click",function(){console.log("click"),document.getElementById("runs").checked?$.getJSON("data/playoffRun.geojson").done(function(t){console.log(t);var r=o(t);console.log(r),e(r.timestamps,t),n(r.min,r.max),a(r.timestamps),L.geoJson(t,{onEachFeature:function(o,e){e.bindPopup(o.properties.name)},pointToLayer:function(o,e){return L.circleMarker(e,{})}})}):$.getJSON("data/StanleyCupWinner.geojson").done(function(t){console.log(t);var r=o(t);console.log(r),e(r.timestamps,t),n(r.min,r.max),a(r.timestamps),L.geoJson(t,{onEachFeature:function(o,e){e.bindPopup(o.properties.name)},pointToLayer:function(o,e){return L.circleMarker(e,{})}})})})});